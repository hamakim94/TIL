# 1. 섹션 5. HTTP METHOD 활용



## 클라이언트에서 서버로 데이터 전송



크게 2가지 방식

- **QUERY (query string)**
  - GET
  - 정렬 필터(검색어)
- **메세지 바디를 통한 데이터 전송**
  - POST, PUT, PATCH
  - 회원 가입, 상품 주문, 리소스 등록, 리소스 변경 등등

###### 

### 정적 데이터 조회

쿼리 파라미터 미사용

- 이미지 같은 경우 -> 그냥 uri로



동적 파라미터 필요하는 경우(query param)

- 검색, 게시판 목록 등
- ?, & 사용해서 전달
- 이 파라미터를 기반으로 정렬 필터에서 결과를 동적으로 생성



HTML Form 데이터 전송

- POST 전송 - 저장
- Content-Type : application/x-www-form-urlencoded 
  - username=Kim&age=20
  - 쿼리파라미터랑 유사한 형식(키 - 벨류) http body에 들어감
- 만약 POST 말고 GET으로 하면
  - 그냥 url에 쿼리 파라미터로 바꿔서 보내줌
  - POST면 message body에 들어간다



multipart/form-data

- 클라쪽에서, enctype="multipart/form-data"
- 서버, Content-Type: multipart/form-data; boundary=---xxx
  - 특정 boundary로 -xxx기반으로 잘라줌
  - 파일 안에서 Content-Type: image/png
  - 즉, 여러가지 타입으로(multi-part) 보내는데, boundary 기준으로 각각 다른 형태의 데이터(폼, 이진 데이터) 등등을 전달할 수 있다

cf) HTMP Form 전송은 GET,POST만 지원~



### HTTP API 데이터 전송

- 서버  to 서버
  - 백엔드 시스템 통신
- 앱 클라이언트
  - 아이폰, 안드로이드
- 웹 클라이언트
  - HTML에서 Form 대신 JS를 통한 통신에 사용(AJAX)
  - React, Vue.js 
- POST, PUT, PATCH : 메시지 바다리르 통해 데이터 전송 가능
- Content-Type: appicaition/json을 주로 사용(사실상 표준)



## HTTP API 설계 예시



### HTTP API - 컬렉션

- **POST 기반**
- 예) 회원 관리 API 제공



### HTTP API - 스토어

- PUT 기반 등록
- 정적 컨텐츠 관리



### HTML FROM 활용



---

### 회원 관리 시스템

- API 설계 - POST 기반 등록
- /members 라는걸 컬렉션으로 한다
  - METHOD를 POST로 하면 회원 등록!
  - PUT은, 게시판 수정할 떄 좋다.(완전히 덮기)
  - 회원 같은 경우는, 부분 수정 -> PATCH

클라이언트는 등록될 리소스의 URI를 모름..!!!!!

- POST 요청은 주로 리소스에서 URI를 식별해 새로운걸 만들어 준다?
- **서버가 새로 등록된 리소스 URI를 생성해줌**



#### 컬렉션

- 서버가 관리하는 리소스 디렉토리
- 서버가 리소스의 URI를 생석하고 관리
- 여기서 컬렉션은 /members

---

### PUT 기반 등록

- 파일 목록 /files -> GET
- 파일 조회 /files/{filename} -> GET
- 파일 등록 /files/{filename} -> PUT ( 기존 파일이 있으면, 다시 올려야 하기 떄문에 PUT 사용이 맞다)
- 파일 삭제 /files/{filename} -> DELETE
- 파일 대량 등록 /files -> **POST**(임의로 지정함)



그런데.. PUT을 통한 신규 자원 등록 특징

- 클라이언트가 리소스 URI를 알고 있어야 함
  - 파일 등록 /files/{filename} -> PUT
  - PUT **/files/stars.jpg**
- 클라이언트가 직접 리소스의 URI를 지정함...



#### Store

- 클라이언트가 관리하는 리소스 저장소
- 클라이언트가 리소스의 URI를 알고 관리
- 여기서 스토어는 /files



**대부분 Collection을 하지, PUT을 사용하는건 거의 없음..!!**

---

### HTML FORM 사용

- **GET, POST만 지원**
- AJAX 같은 기술을 사용해서 해결 가능 -> 회원 API 참고
- 여기서는 순수 HTML, HTML FORM 이야기
- GET, POST만 지원하므로 제약이 있는 편



회원 등록 폼, 회원 등록 URI를 일치시키면, 강사님은 개인척으로 추천 함, 만약 에러가 생기면 URI 자원이 변해야 하므로, 귀찮다!



#### 컨트롤 URI

- GET, POST 지원 -> 제약
- 동사로 된 리소스 경로 사용
- /new, /edit, /delete 등등
- HTTP METHOD로 해결하기 애매한 경우 사용(HTTP API 포함)

실무에선, 생각보다 많이 쓴다 ㅋㅋ(그런데 무식하게 쓰면 안 돼, 최대한 리소스 - URI, 컨트롤 URI는 대체재)

---



### 참고하면 좋은  API?

- practice들이 모여있음
- https://restfulapi.net/resource-naming



- 문서
  - 단일 개념(파일 하나, 객체 인스턴스, 데이터베이스  row)
  - /members/100, /files/star.jpg
- **컬랙션**
  - 서버가 관리하는 리소스 디렉터리
  - 러버가 리소스의 URI를 생성하고 관리
  - /members
- 스토어
  - 클라이언트가 관리하는 자원 저장소
  - 클라이언트가 리소스의 URI를 알고 관리
  - /files ( PUT )
- 컨트롤러, 컨트롤 URI
  - 문서, 컬렉션, 스토어로 해결하기 어려운 추가 프로세스 실행
  - 동사를 직접 사용
  - /members/{id}/delete













