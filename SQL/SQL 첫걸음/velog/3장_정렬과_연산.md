## 9강_정렬 - ORDER BY

### 0. 들어가기 전에(SYNTAX)

``` sql
SELECT 열명 FROM 테이블명 WHERE 조건식 ORDER BY 열명;
```

### 1. ORDER BY로 검색 결과 정렬하기

행의 순서가 바뀜

조건식이 필요없는 경우 WHERE절 생략 가능

### 2. ORDER BY DESC로 내림차순 정렬하기

DESC(내림차순), ASC(기본 값, 오름차순)

### 3. 대소관계

수치형, 날짜시간형 -> 숫자 크기로 판별

**문자열형 데이터 -> 사전식 순서**

1, 3, 10

 '1', '10', '3' , **수치형(날짜시간형), 문자열형 -> 대소관계 계산 방법이 다름**

### 4. ORDER BY는 테이블에 영향을 주지 않음

ONLY 참조!



## 10강_복수의 열을 지정해 정렬하기

### 0_들어가기 전에(SYNTAX)

``` sql
SELECT 열명 FROM 테이블명 WHERE 조건식
ORDER BY 열명1 {ASC|DESC}, 열명2 {ASC,DESC}
```

NULL값은 어떻게?



### 1. 복수 열로 정렬 지정

첫째 기준이 같은 경우, 그 다음 열도 정렬을 해줘야 하는 경우가 많다

### 2. 정렬 방법 지정하기

ASC,DESC부분 생략 가능

### 3. NULL값의 정렬 순서

데이터베이스 제품에 따라 순서는 다르다

MySQL은 NULL값을 가장 작은 값으로 둠, ASC시 가장 앞에 존재한다



## 11강_결과 행 제한하기 - LIMIT

### 0_들어가기 전에(SYNTAX)

```sql
SELECT 열명 FROM 테이블명 LIMIT 행수 [OFFSET 시작행]
```

### 1. 행수 제한

LIMIT 구는 표준 SQL 아님, MySQL, PostgreSQL에서만 사용

**LIMIT구로 반환될 행수 제한 가능!!**

보통 정렬 후 제한한다.



**SQL Server**, SELECT TOP 3 FROM ...

**Oracle**, WHERE ROWNUM <= 3;

- 이 떄 ROWNUM은 클라이언트한테 보여질 때 각 행에 **할당**되는 행 번호
- 정렬하기 전에 처리되어 결과값이 다룬다
  - 세부적으로 하면 **서브쿼리** 사용



### 2. OFFSET 지정

OFFSET : 행 - 1 (0부터 시작)



## 12강_수치 연산

### 0. 들어가기 전에(SYNTAX)

```sql
+ - / % MOD
```

### 1. 사칙 연산

**위 연산자를 활용해 여러 가지 연산을 할 수 있다!**

우선 순위

1. *, /, %
2. \+ -

### 2. SELECT 구로 연산하기

```sql
SELECT 식 1, 식 2... FROM 테이블명
```

### 3. 열의 별명

```sql
SELECT 열1*열2 AS PRODUCT FROM 테이블명
```

**AS 생략 가능**

**이름에 ASCII 문자 이외의 것을 포함 -> 더블쿼트로 둘러싸!**

cf) 싱글쿼트는 문자열 상수

예약어 SELECT를 더블쿼트로 둘러싸 "SELECT"면 테이블명으로 이용 가능



**이름 지정 -> 숫자로 시작하지 않도록!!!!!!**

### 4. WHERE구에서 연산하기

``` sql
SELECT *, price*quantity AS amount FROM sample34
WHERE price*quantity >= 2000;
```

별명 amount 했으니 WHERE구 사용 가능? 

- NOPE
- 처리 순서 : **WHERE 구 -> SELECT 구**

사실 표준SQL은 처리 순서 정해져있지 않지만, 대부분 SELECT를 나중에!

### 5. NULL값의 연산

NULL + 1 ?

**NULL로 연산 -> 결과는 NULL**



### 6. ORDER BY 구에서 연산하기

``` sql
SELECT *, price*quantity AS amonunt
FROM smaple34
ORDER BY amount DESC;
```

처리 순서 : WHERE -> SELECT(별명 지정) -> ORDER BY(별명 사용 가능)

**ORDER BY 구에서는 SELECT에서 지정한 별명 사용 가능**



### 7. 함수

``` sql
함수명(인수1, 인수2... )
```

10 % 3 -> 1

MOD(10, 3) -> 1

**함수도 연산자도, 표기 방법이 다를 뿐 같은 것!!!**



### 8. ROUND 함수

반올림, 소숫점 이하를 반올림

소숫점 둘째 자리에서 반올림 -> ROUND(열명, 1)

**소숫점 자리수는 0부터 시작한다고 생각하면 매우 편함!!**

103.2 -> (-2, -1, 0, 1)



cf) 버림 - TRUNCATE



## 13강_문자열 연산

``` sql
# SYNTAX
+ || CONCAT SUBSTRING TRIM CHARACTER_LENGTH
```

### 1. 문자열 결합

'ABC' || '1234' -> 'ABC1234'

**+(SQL SERVER), || (ORACLE, DB2, PostgreSQL), CONCAT(MySQL)**



### 2. SUBSTRING(SUBSTR) 함수

문자열의 일부분

SUBSTRING('20140125001', 1, 4) -> '2014'

**여기선 인덱스가 1부터 시작하니까, 직접 해보고 쓰기**

### 3. TRIM 함수

문자열의 앞뒤로 여분의 스페이스가 있을 경우 이를 제거( 문자열 중간 스페이스 중간은 삭제 X)

### 4. CHARACTER_LENGTH 함수

문자열의 길이를 개산해 돌려주는 함수

**OCTET_LENGTH 함수 -> 문자열의 길이를 바이트 단위로 계산해 돌려주는 함수**



#### **cf) LENGTH VS CHAR_LENGTH**

``` sql
SELECT LENGTH('Hello');  -- Returns 5 (5 bytes)
SELECT LENGTH('해삼');    -- Returns 6 (3 bytes for each Korean character)
```

``` sql
SELECT CHAR_LENGTH('Hello');  -- Returns 5 (5 characters)
SELECT CHAR_LENGTH('해삼');    -- Returns 2 (2 Chinese characters)
```

만약 한국어도 글자수로 하면 -> CHAR_LENGTH로 계산해야 함..!



**문자세트(Character Set)마다 ASCII를 제외한 다른 문자들은 할당되는 크기가 다름에 유의**



## 14강_날짜 연산

``` sql
# 날짜 연산 SYNTAX
CURRENT_TIMESTAMP, CURRENT_DATE, INTERVAL
```

사실 DB 제품에 따라 다름



### 1. SQL에서의 날짜

기간형(interval) -> 10일간, 2시간 10분 -> 시간의 간격 표현 가능



**CURRENT_TIMESTAMP -> 인수 X 함수 -> 시스템 날짜**

SELECT CURRENT_TIMESTAMP;

**-날짜 서식**

- 2014/01/25
- 2014-01-25
- 25 Jan 214

#### **cf) date_format('2014-01-25', '%Y-%m-%d') -> 2014-01-25 => SQL 문제 자주 출제**



### 2. 날짜의 덧셈과 뺄셈

``` sql
SELECT CURRENT_TIMESTAMP + INTERVAL 1 DAY;
```

- 시스템 시간 1일 후 날짜 조회하는 SELECT
- 표준화 되지 않았으니 DB 메뉴얼 참조



뺄샘도 가능, Mysql 

``` mysql
DATEDIFF('2014-02-28', '2014-01-01') # 날짜 계산(일)
```



## 15강_CASE 문으로 데이터 변환(중요!!!)

``` mysql
-- CASE 문 SYNTAX
CASE 
	WHEN 조건식1 THEN 식1
	[WHEN 조건식2 THEN 식2 ...]
	[ELSE 식 3]
END
```

### 1. CASE문

사용자 정의 함수 대신 간단한건 CASE문으로 처리하자

NULL값을 0으로 변환하는 CASE 식?

``` mysql
SELECT a, 
	CASE
		WHEN a IS NULL THEN 0
		ELSE a
  END 'a(null=0)'
FROM 테이블명;
```



#### \- COALESCE 함수

SELECT a, COALESCE(a, 0) FROM 테이블명;

**NULL이 아닌 값에 대해서는 가장 먼저 지정된 인수의 값을 반환(왼->오로 탐색한다 생각)**



### 2. 또 하나의 CASE 문

단순 CASE

CASE 식 WHEN 식 THEN 식 ...



1 -> 남자, 2 -> 여자로 Decoding 하는 2가지 case

**검색 CASE**

``` sql
SELECT a AS "코드",
CASE
	WHEN a = 1 THEN '남자'
	WHEN a = 2 THEN '여자'
	ELSE '미지정'
END AS "성별"
FROM 테이블명
```

**단순 CASE**

``` sql
SELECT a AS "코드",
CASE a
	WHEN 1 THEN '남자'
	WHEN 2 THEN '여자'
	ELSE '미지정'
END as "성별" 
FROM 테이블명;
```

**식을 어디에 넣는지에 따라 나뉜다(너무 자세히 구분하진 말자, 헷갈림)**



### 3. CASE를 사용할 경우 주의사항

CASE문은 어디에서나 사용 가능 - WHERE, ORDER BY, SELECT 다 사용 가능

**ELSE를 생략 -> ELSE NULL이 된다는 것 유의**

절대 생략하지 말자하



#### **\- WHEN에 NULL 지정**

**단순 CASE문에서는 NULL을 비교 못 함(IS NULL 연산자 사용해야함)**

검색 CASE문 사용



**표준 SQL 문법 최대한 사용하자!!**

- DECODE - only oracle, **CASE -> 표준 SQL** -> 어디에서나 사용 가능
- NULL값 반환 - ORACLE NVL, SqlServer ISNULL
  - **표준 SQL -> COALESCE함수 사용하자**