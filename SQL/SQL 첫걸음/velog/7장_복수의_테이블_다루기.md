## 31강_집합 연산

cf) **관계형 모델** - 수학 집합론의 관계형 이론

-  결국 데이터를 **집합**으로 다루자



### 1.  SQL과 집합

SELECT -> 하나의 집합 반환

### 2. UNION으로 합집합 구하기

{1, 2, 3} U {2, 10, 13} -> {1,2,3,10,13}

**\- UNION**

SELECT 한 결과를 편의상 A, B라고 함(테이블, 즉 집합이 SQL의 기본 단위이기 때문)

A UNION B;

**UNION으로 두 개의 SELECT 명령을 하나로 연계해 질의 결과를 얻을 수 있음**

``` sql
SELECT ...
UNION
SELECT ...
UNION
SELECT ...; -- 가능
```



#### UNION 사용할 때의 ORDER BY

- 마지막 SELECT 명령에서만 가능
  - **UNION -> 가장 마지막 SELECT 명령에서 가능!**
  - **테이블마다 열의 이름이 다를 수 있으니까, 별명 사용해서 일치!**



**\- UNION ALL** 

중복 제거하고 싶지 않을 때 

**성능적으로 유리한 부분이 있음(중복체크를 안 하니까!)**



### 3. 교집합과 차집합

MYSQL에서는 지원 X

SQL - INTERSECT, EXCEPT(ORACLE - MINUS) 



## 32강_테이블 결합 - 너무 중요해!!

### 0. 너무 중요하게 생각했던 부분 - 외부 조인, 내부 조인에서 결국 곱 집 합 은 한 다.

- **곱집합 후 조건으로 걸러내는건 기본이야!!**
- 막 INNER JOIN, LEFT OUTER JOIN이 특출나게 다른게 절대 아니다.
- **결 국 곱 집 합 은 한 다 !**



집합 연산 -> 세로로 데이터가 늘어남

테이블 결합 -> 가로로 데이터가 늘어남

- **기본 : 곱집합**



### 1. 곱집합과 교차결합

카타시안 곱

- A, B, C

- 1, 2, 3 의 곱집합

- |       | **1**  | **2** | **3** |
  | ----- | ------ | ----- | ----- |
  | **A** | **A1** | A2    | A3    |
  | **B** | B1     | B2    | B3    |
  | **C** | C1     | C2    | C3    |

**\- 교차결합(Cross Join)**

``` sql
-- SYNTAX
SELECT * FROM 테이블명1, 테이블명2
```

**FROM구 복수의 테이블 지정 -> 교차결합**

**결합은 가로(열) 방향**



### 2. 내부 결합

보통 기본 키가 있음

``` sql
SELECT * FROM 상품, 재고수
WHERE 상품.상품코드 = 재고수.상품코드; -- 상품코드가 기본키
```

**계산된 곱집합에서 원하는 조건을 걸러내는 걸 내부 결합이라고 함!**

WHERE 구 여러개 -> 첫 번째 : 결합 조건, 두 번쨰 이하 : 검색 조건이라고 부름



### 3. INNER JOIN으로 내부결합하기

``` sql
-- SYNTAX
SELECT * 
FROM 테이블명 
INNER JOIN 테이블명2
ON 결합조건;
```

- 해당 방법이 통용된다( 내부 결합 코드랑 사실 같음, 다만 결합조건이 명확하게 보임)



### 4. 내부결합을 활용한 데이터 관리

테이블명을 매번 쓰는건 어려우니, 별명을 지정한다

**결합 할 땐 테이블 간의 관계(일대다,다대일, 일대일) 중요**

**\- 외부키**

다른 테이블의 기본키를 참조하는 열

**\- 자기결합(Self Join)**

같은 테이블끼리 결합.



### 5. 외부결합 - LEFT [OUTER] JOIN, RIGHT JOIN

**사실, 교차결합 - 결합 조건 지정 검색한다는 기본적인 사고방식은 같음**

'어느 한 쪽에만 존재하는 데이터를 어떻게 다룰지?'

왼쪽에만 있고, 오른쪽에 없는데, LEFT OUTER JOIN ->  NULL



#### cf) 구식 방법 -> WHERE에서 필터링

``` sql
SELECT table1.a, table2.b
FROM table1, table2
WHERE table1.a = table2.a (+) -- ORACLE 특이점, 존재하지 않을 수 있는 테이블 열 (+) 
AND ...;
```

- ORACLE은 이렇게 외부 조인 가능
- SQL SEver는 \*=, =* 연산자 이용
- **하지만 INNER JOIN, LEFT JOIN, RIGHT JOIN -> 표준화!**



## 33강_관계형 모델

관계형 모델에서 사용하는 용어와 SQL에서 사용하는 용어가 다름



### 1. 관계형 모델

기본요소 : **릴레이션(Relation)**

관계형 모델에서 릴레이션은 **테이블이다**



SQL에서 열 - 속성(**attribute**) 

SQL에서 행 - 튜플(**tuple**)



릴레이션 - 튜플의 집합

릴레이션 연산 -> 집합에 대한 연산과 대응된다 -> **관계대수**



기본규칙

- 하나 이상의 관계를 바탕으로 연산한다
- 연산한 결과, 반환되는 것 또한 관계이다
- 연산을 중첩 구조로 실행해도 상관없다



### 2. 관계형 모델과  SQL

**\- 합집합**

릴레이션 덧셈, UNION

**\- 차집합**

릴레이션 뺄셈, EXCEPT

**\- 교집합**

릴레이션 교집합, INTERSECT

**\- 곱집합**

릴레이션 곱집합, 복수 테이블 지정 OR CROSS JOIN

**\- 선택**

튜플의 추출

WHERE구에 조건을 지정해 데이터를 검색하는 것

**\- 투영**

**속성의 추출**

**SELECT구에 결과로 반환할 열을 지정하는 것**

**\- 결합**

Join -> 릴레이션끼리 교차결합 -> 곱집합에서 결합조건을 만족하는 추출

**내부결합, 외부결합 다 있다.**



**테이블 -> 데이터 행의 집합**